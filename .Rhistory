library("stringr")
source("fm_functions.r")
############################################################
##############      GENERATE EVENTS TABLES      ############
############################################################
up_events<-read_html('http://www.fightmetric.com/statistics/events/upcoming')
dn_events<-read_html('http://www.fightmetric.com/statistics/events/completed?page=all')
up_events<-create_event_table(up_events)
dn_events<-create_event_table(dn_events)
############################################################
##############      GENERATE FIGHTER TABLE      ############
############################################################
dn_urls<-as.list(dn_events[2:150,1]) #PAST 3 YEARS (USADA's BEEN IN ~2?)
fighter_table<-NULL
for(i in seq(1:length(dn_urls))){
hld<-get_event_stats(as.character(dn_urls[i]))
fighter_table<-rbind(fighter_table,hld)
}
############################################################
##############     DEV    ##################################
############################################################
#get upcoming event card
card<-pull_upcoming_fighters()
#save table for each fighter
for(i in seq(1,length(card[,1]),1)){
hld<-get_fighter_fights(card[1])
hld<-cbind(hld,calculate_table_score(hld))
write.csv(hld, file=paste("C:\\Users\\C\\Desktop\\fightmetrics-master\\R_fightmetrics\\",card[i],".csv"))
}
write.csv(hld, file=paste("C:\\Users\\C\\Desktop\\fightmetrics-master\\R_fightmetrics\\","master_fighter_table",".csv"))
write.csv(fighter_table, file=paste("C:\\Users\\C\\Desktop\\fightmetrics-master\\R_fightmetrics\\","master_fighter_table",".csv"))
#get upcoming event card
card<-pull_upcoming_fighters()
#save table for each fighter
for(i in seq(1,length(card[,1]),1)){
hld<-get_fighter_fights(card[1])
hld<-cbind(hld,calculate_table_score(hld))
write.csv(hld, file=paste("C:\\Users\\C\\Desktop\\fightmetrics-master\\R_fightmetrics\\",card[i],".csv"))
}
write.csv(card, file=paste("C:\\Users\\C\\Desktop\\fightmetrics-master\\R_fightmetrics\\","up_card",".csv"))
##############      GENERATE UPCOMING CARD     #############
############################################################
#get upcoming event card
card<-pull_upcoming_fighters()
#save table for each fighter
for(i in seq(1,length(card[,1]),1)){
hld<-get_fighter_fights(card[1])
hld<-cbind(hld,calculate_table_score(hld))
write.csv(hld, file=paste("C:\\Users\\C\\Desktop\\fightmetrics-master\\R_fightmetrics\\",card[i],".csv"))
}
write.csv(card, file=paste("C:\\Users\\C\\Desktop\\fightmetrics-master\\R_fightmetrics\\","up_card",".csv"))
vegas<-read_html('http://www.oddsshark.com/ufc/odds')
odds<- vegas %>%
html_nodes("div div") %>%
html_text()
odds[1:20]
class(odds)
str(odds)
typeof(odds)
test<-lapply(odds, str_trim)
test
test[1:10]
test[20:40]
write.csv(odds, file=paste("C:\\Users\\C\\Desktop\\fightmetrics-master\\R_fightmetrics\\","odds",".csv"))
vegas<-read_html('http://www.oddsshark.com/ufc/odds')
odds<- vegas %>%
html_nodes("data-op-moneyline") %>%
html_text()
write.csv(odds, file=paste("C:\\Users\\C\\Desktop\\fightmetrics-master\\R_fightmetrics\\","odds",".csv"))
vegas<-read_html('http://www.oddsshark.com/ufc/odds')
odds<- vegas %>%
html_nodes("span") %>%
html_text()
write.csv(odds, file=paste("C:\\Users\\C\\Desktop\\fightmetrics-master\\R_fightmetrics\\","odds",".csv"))
odds<- vegas %>%
html_nodes("div div") %>%
html_nodes("div div") %>%
html_text()
write.csv(odds, file=paste("C:\\Users\\C\\Desktop\\fightmetrics-master\\R_fightmetrics\\","odds",".csv"))
odds<- vegas %>%
html_nodes("div div") %>%
html_nodes("div div")
write.csv(odds, file=paste("C:\\Users\\C\\Desktop\\fightmetrics-master\\R_fightmetrics\\","odds",".csv"))
odds<- vegas %>%
html_nodes("div div") %>%
html_nodes("div div") %>%
html_attrs()
write.csv(odds, file=paste("C:\\Users\\C\\Desktop\\fightmetrics-master\\R_fightmetrics\\","odds",".csv"))
vegas<-read_html('http://www.gamblerspalace.com/lines/martial-arts/')
odds<- vegas %>%
html_nodes("tr td") %>%
html_text()
write.csv(odds, file=paste("C:\\Users\\C\\Desktop\\fightmetrics-master\\R_fightmetrics\\","odds",".csv"))
length(odds)
mma_odds<-NULL
for(i in seq(8,length(odds),15)){
h1<-odds[i]
h2<-odds[i+3]
h3<-odds[i+10]
hld<-cbind(h1,h2,h3)
mma_odds<-rbind(mma_odds,hld)
}
write.csv(mma_odds, file=paste("C:\\Users\\C\\Desktop\\fightmetrics-master\\R_fightmetrics\\","odds",".csv"))
local_path<-"C:\\Users\\C\\Desktop\\fightmetrics-master\\R_fightmetrics\\"
write.csv(odds, file=paste(local_path,"odds",".csv"))
write.csv(mma_odds, file=paste(local_path,"mma_odds",".csv"))
mma_odds<-NULL
for(i in seq(7,length(odds),15)){
h1<-odds[i]
h2<-odds[i+3]
h3<-odds[i+10]
hld<-cbind(h1,h2,h3)
mma_odds<-rbind(mma_odds,hld)
}
write.csv(odds, file=paste(local_path,"odds",".csv"))
write.csv(mma_odds, file=paste(local_path,"mma_odds",".csv"))
mma_odds<-NULL
for(i in seq(1,length(odds),1)){
if(str_detect(odds[i],"^[A-Z][a-z]+\s.+")){}
h1<-odds[i]
h2<-odds[i+3]
h3<-odds[i+10]
hld<-cbind(h1,h2,h3)
mma_odds<-rbind(mma_odds,hld)
}
write.csv(odds, file=paste(local_path,"odds",".csv"))
write.csv(mma_odds, file=paste(local_path,"mma_odds",".csv"))
mma_odds<-NULL
for(i in seq(1,length(odds),1)){
if(str_detect(odds[i],"^[A-Z][a-z]+\s.+")){
h1<-odds[i]
h2<-odds[i+3]
h3<-odds[i+10]
hld<-cbind(h1,h2,h3)
mma_odds<-rbind(mma_odds,hld)
}
}
write.csv(odds, file=paste(local_path,"odds",".csv"))
write.csv(mma_odds, file=paste(local_path,"mma_odds",".csv"))
mma_odds<-NULL
for(i in seq(1,length(odds),1)){
if(str_detect(odds[i],"^[A-Z][a-z]+\\s.+")){
h1<-odds[i]
h2<-odds[i+3]
h3<-odds[i+10]
hld<-cbind(h1,h2,h3)
mma_odds<-rbind(mma_odds,hld)
}
}
write.csv(odds, file=paste(local_path,"odds",".csv"))
write.csv(mma_odds, file=paste(local_path,"mma_odds",".csv"))
mma_odds<-NULL
for(i in seq(1,length(odds),1)){
if(str_detect(odds[i],"^[A-Z][a-z]+\\s.+")){
h1<-odds[i]
h2<-odds[i+3]
h3<-odds[i+10]
hld<-cbind(h1,h2,h3)
mma_odds<-rbind(mma_odds,hld)
}
}
write.csv(odds, file=paste(local_path,"odds",".csv"))
write.csv(mma_odds, file=paste(local_path,"mma_odds",".csv"))
mma_odds<-NULL
for(i in seq(1,length(odds),1)){
if(str_detect(odds[i],"^[A-Z][a-z]+\\s.+") & str_trim(odds[i]) != "Bet Now"){
h1<-odds[i]
h2<-odds[i+3]
h3<-odds[i+10]
hld<-cbind(h1,h2,h3)
mma_odds<-rbind(mma_odds,hld)
}
}
write.csv(odds, file=paste(local_path,"odds",".csv"))
write.csv(mma_odds, file=paste(local_path,"mma_odds",".csv"))
mma_odds<-NULL
for(i in seq(1,length(odds),1)){
if(str_detect(odds[i],"^[A-Z][a-z]+\\s.+") & str_trim(odds[i]) != "Bet Now"){
h1<-odds[i]
h2<-odds[i+3]
hld<-cbind(h1,h2)
mma_odds<-rbind(mma_odds,hld)
}
}
write.csv(odds, file=paste(local_path,"odds",".csv"))
write.csv(mma_odds, file=paste(local_path,"mma_odds",".csv"))
source("fm_functions.r")
odds<-get_betting_odds()
write.csv(odds, file=paste(local_path,"odds",".csv"))
fighter_table <- read.csv(file=paste(local_path,"master_fighter_table",".csv"), header=TRUE, sep=",")
up_events <- read.csv(file=paste(local_path,"up_events",".csv"), header=TRUE, sep=",")
dn_events <- read.csv(file=paste(local_path,"dn_events",".csv"), header=TRUE, sep=",")
card <- read.csv(file=paste(local_path,"up_card",".csv"), header=TRUE, sep=",")
odds <- read.csv(file=paste(local_path,"odds",".csv"), header=TRUE, sep=",")
View(card)
View(odds)
write.csv(odds, file=paste(local_path,"odds",".csv"), row.names=FALSE)
odds<-get_betting_odds()
write.csv(odds, file=paste(local_path,"odds",".csv"), row.names=FALSE)
odds<-get_betting_odds()
write.csv(odds, file=paste(local_path,"odds",".csv"), row.names=FALSE)
fighter_table <- read.csv(file=paste(local_path,"master_fighter_table",".csv"), header=TRUE, sep=",")
card <- read.csv(file=paste(local_path,"up_card",".csv"), header=TRUE, sep=",")
odds <- read.csv(file=paste(local_path,"odds",".csv"), header=TRUE, sep=",")
#path <- fighter name or card[]
#fighter <- read.csv(file=paste(local_path,path,".csv"), header=TRUE, sep=",")
View(card)
View(odds)
View(fighter_table)
card
test<-merge(card, odds, by.x="name", by.y="name")
View(test)
up_card<-merge(card, odds, by.x="name", by.y="name")
test<-merge(up_card, fighter_table, by.x="name", by.y="name")
View(test)
test<-merge(up_card, fighter_table, by.x="name", by.y="name", all.x = TRUE)
View(test)
card
source("fm_functions.r")
#get upcoming event card
card<-pull_upcoming_fighters()
#save table for each fighter
for(i in seq(1,length(card[,1]),1)){
hld<-get_fighter_fights(card[1])
hld<-cbind(hld,calculate_table_score(hld))
write.csv(hld, file=paste(local_path,card[i],".csv"))
}
write.csv(card, file=paste(local_path,"up_card",".csv"))
View(card)
source("fm_functions.r")
card<-pull_upcoming_fighters()
#save table for each fighter
for(i in seq(1,length(card[,1]),1)){
hld<-get_fighter_fights(card[1])
hld<-cbind(hld,calculate_table_score(hld))
write.csv(hld, file=paste(local_path,card[i],".csv"))
}
write.csv(card, file=paste(local_path,"up_card",".csv"))
View(card)
length(card[,1])
card
for(i in seq(1,length(card[,1]),1)){
hld<-get_fighter_fights(card[i])
hld<-cbind(hld,calculate_table_score(hld))
write.csv(hld, file=paste(local_path,card[i],".csv"))
}
write.csv(card, file=paste(local_path,"up_card",".csv"))
length(card)
card<-pull_upcoming_fighters()
#save table for each fighter
for(i in seq(1,length(card[,2]),1)){
hld<-get_fighter_fights(card[i])
hld<-cbind(hld,calculate_table_score(hld))
write.csv(hld, file=paste(local_path,card[i],".csv"))
}
write.csv(card, file=paste(local_path,"up_card",".csv"))
hld<-get_fighter_fights(card[i])
hld
hld<-get_fighter_fights(card[1])
hld
card
fighter_table
card<-pull_upcoming_fighters()
#save table for each fighter
# for(i in seq(1,length(card[,2]),1)){
#   hld<-get_fighter_fights(card[i])
#   hld<-cbind(hld,calculate_table_score(hld))
#   write.csv(hld, file=paste(local_path,card[i],".csv"))
# }
write.csv(card, file=paste(local_path,"up_card",".csv"))
source("fm_functions.r")
#get upcoming event card
card<-pull_upcoming_fighters()
#save table for each fighter
# for(i in seq(1,length(card[,2]),1)){
#   hld<-get_fighter_fights(card[i])
#   hld<-cbind(hld,calculate_table_score(hld))
#   write.csv(hld, file=paste(local_path,card[i],".csv"))
# }
write.csv(card, file=paste(local_path,"up_card",".csv"))
source("fm_functions.r")
#get upcoming event card
card<-pull_upcoming_fighters()
#save table for each fighter
# for(i in seq(1,length(card[,2]),1)){
#   hld<-get_fighter_fights(card[i])
#   hld<-cbind(hld,calculate_table_score(hld))
#   write.csv(hld, file=paste(local_path,card[i],".csv"))
# }
write.csv(card, file=paste(local_path,"up_card",".csv"))
for(i in seq(1,length(card[,2]),1)){
hld<-get_fighter_fights(card[i])
hld<-cbind(hld,calculate_table_score(hld))
write.csv(hld, file=paste(local_path,card[i],".csv"))
}
for(i in seq(1,length(card[,2]),1)){
fighter<-get_fighter_fights(card[i])
fighter<-cbind(fighter,calculate_table_score(fighter))
write.csv(hld, file=paste(local_path,card[i],".csv"))
}
fighter<-get_fighter_fights(card[1])
fighter<-cbind(fighter,calculate_table_score(fighter))
fighter
fighter<-get_fighter_fights(card[1])
length(fighter[,1])
seq(1,length(fighter[,1]),1)
fighter[1]
fighter[1,]
fighter[2,]
fighter[14,]
fighter
source("fm_functions.r")
# save table for each fighter
for(i in seq(1,length(card[,2]),1)){
fighter<-get_fighter_fights(card[i])
fighter<-cbind(fighter,calculate_table_score(fighter))
write.csv(hld, file=paste(local_path,card[i],".csv"))
}
# save table for each fighter
for(i in seq(1,length(card[,2]),1)){
fighter<-get_fighter_fights(card[i])
fighter<-cbind(fighter,calculate_table_score(fighter))
write.csv(hld, file=paste(local_path,card[i],".csv"))
}
fighter<-get_fighter_fights(card[i])
fighter
i<-1
fighter<-get_fighter_fights(card[i])
fighter
i<-1
fighter
fighter<-cbind(fighter,calculate_table_score(fighter))
fighter
for(i in seq(1,length(card[,2]))){
fighter<-get_fighter_fights(card[i])
fighter<-cbind(fighter,calculate_table_score(fighter))
write.csv(hld, file=paste(local_path,card[i],".csv"))
}
# save table for each fighter
for(i in seq(1,length(card[,2]),1)){
fighter<-get_fighter_fights(card[i])
fighter<-cbind(fighter,calculate_table_score(fighter))
write.csv(hld, file=paste(local_path,card[i],".csv"))
}
card
source("fm_functions.r")
# save table for each fighter
for(i in seq(1,length(card[,2]),1)){
fighter<-get_fighter_fights(card[i])
fighter<-cbind(fighter,calculate_table_score(fighter))
write.csv(hld, file=paste(local_path,card[i],".csv"))
}
source("fm_functions.r")
# save table for each fighter
for(i in seq(1,length(card[,2]),1)){
fighter<-get_fighter_fights(card[i])
fighter<-cbind(fighter,calculate_table_score(fighter))
write.csv(hld, file=paste(local_path,card[i],".csv"))
}
card
fighter<-get_fighter_fights(card[7])
fighter<-cbind(fighter,calculate_table_score(fighter))
fighter
fighter<-get_fighter_fights(card[12])
fighter<-cbind(fighter,calculate_table_score(fighter))
fighter
fighter<-get_fighter_fights(card[21])
fighter<-cbind(fighter,calculate_table_score(fighter))
fighter
fighter<-get_fighter_fights(card[24])
fighter<-cbind(fighter,calculate_table_score(fighter))
fighter
fighter<-get_fighter_fights(card[23])
fighter<-cbind(fighter,calculate_table_score(fighter))
fighter
card[24]
fighter<-get_fighter_fights(card[24])
fighter
# save table for each fighter
for(i in seq(1,length(card[,2]),1)){
fighter<-get_fighter_fights(card[i])
if(is.null(fighter)==FALSE) {fighter<-cbind(fighter,calculate_table_score(fighter))}
write.csv(hld, file=paste(local_path,card[i],".csv"))
}
write.csv(card, file=paste(local_path,"up_card",".csv"))
fighter<-get_fighter_fights(card[1])
fighter
fighter<-cbind(fighter,calculate_table_score(fighter))
fighter
card<-pull_upcoming_fighters()
# save table for each fighter
for(i in seq(1,length(card[,2]),1)){
fighter<-get_fighter_fights(card[i])
if(is.null(fighter)==FALSE) {fighter<-cbind(fighter,calculate_table_score(fighter))}
write.csv(fighter, file=paste(local_path,card[i],".csv"))
}
write.csv(card, file=paste(local_path,"up_card",".csv"))
#get upcoming event card
card<-pull_upcoming_fighters()
# save table for each fighter
for(i in seq(1,length(card[,2]),1)){
fighter<-get_fighter_fights(card[i])
if(is.null(fighter)==FALSE) {fighter<-cbind(fighter,calculate_table_score(fighter))}
write.csv(fighter, file=paste(local_path,card[i],".csv"), row.names=FALSE)
}
write.csv(card, file=paste(local_path,"up_card",".csv"), row.names=FALSE)
card
up_card<-merge(card, odds, by.x="name", by.y="name")
test<-merge(up_card, fighter_table, by.x="name", by.y="name", all.x = TRUE)
View(test)
View(fighter_table)
up_card
up_card[1,c("name")]
test<-read.csv(file=paste(local_path,up_card[1,c("name")],".csv"))
View(test)
fights<-read.csv(file=paste(local_path,up_card[1,c("name")],".csv"))
fights
fights[which(fights[,2]==up_card[1,c("name")])]
fights[which(as.character(fights[,2])==as.character(up_card[1,c("name")])]
fights[,which(as.character(fights[,2])==as.character(up_card[1,c("name")])]
fights<-subset(fights,name=as.character(up_card[1,c("name")]))
fights
fights<-read.csv(file=paste(local_path,up_card[1,c("name")],".csv"))
fights<-subset(fights,name=as.character(up_card[1,c("name")]))
fights
fights<-subset(fights,name=as.character(up_card[,c("name")]))
fights
fights<-subset(fights,name=as.character(up_card[,c("name")]))
fights
fights<-subset(fights,name==as.character(up_card[,c("name")]))
fights
fights<-fights[fights$name==as.character(up_card[,c("name")])]
fights
fights<-fights[fights$name==as.character(up_card[1,c("name")])]
fights
fights<-read.csv(file=paste(local_path,up_card[1,c("name")],".csv"))
fights<-fights[fights$name==as.character(up_card[1,c("name")])]
fights
fights<-read.csv(file=paste(local_path,up_card[1,c("name")],".csv"))
fights<-fights[,fights$name==as.character(up_card[1,c("name")])]
fights
fights<-read.csv(file=paste(local_path,up_card[1,c("name")],".csv"))
fights<-as.data.frame(fights)
fights<-fights[,fights$name==as.character(up_card[1,c("name")])]
fights
fights<-read.csv(file=paste(local_path,up_card[1,c("name")],".csv"))
fights<-as.data.frame(fights)
fights<-fights[fights$name==as.character(up_card[1,c("name")])]
fights
fights<-read.csv(file=paste(local_path,up_card[1,c("name")],".csv"))
fights
fights<-as.data.frame(fights)
fights<-fights[fights$name==as.character(up_card[1,c("name")]),]
fights
fights<-fights[fights$name==as.character(up_card[1,c("name")]),c("score")]
fights
summary(fights)
fights<-summary(fights)
fights<-read.csv(file=paste(local_path,up_card[1,c("name")],".csv"))
fights<-as.data.frame(fights)
fights<-fights[fights$name==as.character(up_card[1,c("name")]),c("score")]
fights<-summary(fights)
fights<-fights[1,c("Min.", "Mean", "Max.")]
fights<-fights[c("Min.", "Mean", "Max.")]
fights
colnames(fights)<-c("min","avg","max")
names(fights)<-c("min","avg","max")
fights
up_card
x<-up_card
for(i in seq(1,length(x[,1]),1)){
fights<-read.csv(file=paste(local_path,x[1,c("name")],".csv"))
fights<-as.data.frame(fights)
fights<-fights[fights$name==as.character(x[1,c("name")]),c("score")]
fights<-summary(fights)
fights<-fights[c("Min.", "Mean", "Max.")]
names(fights)<-c("min","avg","max")
test<-get_fights_sums(up_card)
get_fights_sums<-function(x){
x<-up_card
hld<-NULL
for(i in seq(1,length(x[,1]),1)){
fights<-read.csv(file=paste(local_path,x[1,c("name")],".csv"))
fights<-as.data.frame(fights)
fights<-fights[fights$name==as.character(x[1,c("name")]),c("score")]
fights<-summary(fights)
fights<-fights[c("Min.", "Mean", "Max.")]
names(fights)<-c("min","avg","max")
h1<-x[i,]
h2<-fights
hld<-rbind(hld,cbind(h1,h2))
}
}
test<-get_fights_sums(up_card)
get_fights_sums<-function(x){
x<-up_card
hld<-NULL
for(i in seq(1,length(x[,1]),1)){
fights<-read.csv(file=paste(local_path,x[1,c("name")],".csv"))
fights<-as.data.frame(fights)
fights<-fights[fights$name==as.character(x[1,c("name")]),c("score")]
fights<-summary(fights)
fights<-fights[c("Min.", "Mean", "Max.")]
names(fights)<-c("min","avg","max")
h1<-x[i,]
h2<-fights
hld<-rbind(hld,cbind(h1,h2))
}
}
test<-get_fights_sums(up_card)
up_card
card
