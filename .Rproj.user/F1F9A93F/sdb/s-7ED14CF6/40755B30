{
    "contents" : "############################################################\n##############      UTILITIES     ##########################\n############################################################\nlibrary(\"rvest\")\nlibrary(\"stringr\")\nrequire(\"combinat\")\nsource(\"fm_functions.r\")\nlocal_path<-\"C:\\\\git\\\\fightmetrics\\\\data\\\\\"\n\n################################################################################\n##########################     TO REFRESH      #################################\n################################################################################\n\n# \n# ############################################################\n# ##############      GENERATE EVENTS TABLES      ############\n# ############################################################\n# up_events<-read_html('http://www.fightmetric.com/statistics/events/upcoming')\n# dn_events<-read_html('http://www.fightmetric.com/statistics/events/completed?page=all')\n# up_events<-create_event_table(up_events)\n# dn_events<-create_event_table(dn_events)\n# write.csv(up_events, file=paste(local_path,\"up_events\",\".csv\"), row.names=FALSE)\n# write.csv(dn_events, file=paste(local_path,\"dn_events\",\".csv\"), row.names=FALSE)\n# \n# ############################################################\n# ##############      GENERATE FIGHTER TABLE      ############\n# ##############      TAKES A BIT THE LONGER YOU GO   ########\n# ############################################################\n# \n# dn_urls<-as.list(dn_events[2:150,1]) #PAST 3 YEARS (USADA's BEEN IN ~2?)\n# fighter_table<-NULL\n# for(i in seq(1:length(dn_urls))){\n#   hld<-get_event_stats(as.character(dn_urls[i]))\n#   fighter_table<-rbind(fighter_table,hld)\n# }\n# write.csv(fighter_table, file=paste(local_path,\"master_fighter_table\",\".csv\"), row.names=FALSE)\n# \n# ############################################################\n# ##############      GENERATE UPCOMING CARD     #############\n# ############################################################\n# #get upcoming event card\n# card<-pull_upcoming_fighters()\n# \n# # save table for each fighter\n# for(i in seq(1,length(card[,2]),1)){\n#   fighter<-get_fighter_fights(card[i])\n#   if(is.null(fighter)==FALSE) {fighter<-cbind(fighter,calculate_table_score(fighter))}\n#   write.csv(fighter, file=paste(local_path,card[i],\".csv\"), row.names=FALSE)\n# }\n# \n# write.csv(card, file=paste(local_path,\"up_card\",\".csv\"), row.names=FALSE)\n# \n# ############################################################\n# ##############      GET VEGAS ODDS              ############\n# ############################################################\n# odds<-get_betting_odds()\n# write.csv(odds, file=paste(local_path,\"odds\",\".csv\"), row.names=FALSE)\n\n\n# \n# #################################################################################\n# ###########################     TO LOAD     #####################################\n# #################################################################################\n# up_events <- read.csv(file=paste(local_path,\"up_events\",\".csv\"), header=TRUE, sep=\",\")\n# dn_events <- read.csv(file=paste(local_path,\"dn_events\",\".csv\"), header=TRUE, sep=\",\")\n# fighter_table <- read.csv(file=paste(local_path,\"master_fighter_table\",\".csv\"), header=TRUE, sep=\",\")\n# card <- read.csv(file=paste(local_path,\"up_card\",\".csv\"), header=TRUE, sep=\",\")\n# odds <- read.csv(file=paste(local_path,\"odds\",\".csv\"), header=TRUE, sep=\",\")\n# #path <- fighter name or card[]\n# #fighter <- read.csv(file=paste(local_path,path,\".csv\"), header=TRUE, sep=\",\")\n# \n# \n# #################################################################################\n# ###########################     MANIPULATION     ################################\n# #################################################################################\n# \n# #http://www.gamblerspalace.com/lines/martial-arts/ -> fightmetrics \n# #IF ERRORS FIRE ADD N/A NAMING CONVERSION TO FUNCTION\n# odds <- read.csv(file=paste(local_path,\"odds\",\".csv\"), header=TRUE, sep=\",\")\n# odds<-fix_odds_names(odds)\n# \n# #merge odds to upcoming card & add stats \n# up_card<-merge(card, odds, by.x=\"name\", by.y=\"name\", all.x=TRUE)\n# up_card<-get_fights_sums(up_card)\n# #set up for side b side\n# up_card[c(\"against\")] <- lapply(up_card[c(\"against\")], toupper)\n# \n# #################################################################################\n# ############     INSERT DRAFT KINGS SALARIES     ################################\n# #################################################################################\n# \n# salaries <- read.csv(file=paste0(local_path,\"DKSalaries\",\".csv\"), header=TRUE, sep=\",\")\n# salaries <-salaries[,2:3]\n# salaries[,1] <-toupper(salaries[,1])\n# up_card<-append_dk_salary(up_card,salaries)\n# \n# #make export/import card#\n# sbs_up_card<-create_fights_view(up_card)\n# sbs_up_card<-cbind(sbs_up_card, \"\", \"\")\n# colnames(sbs_up_card)<-c(colnames(sbs_up_card[1:14]),\"pool\",\"proj\")\n# \n# #up_card = vertical data \n# #sbs_up_card = horizontal data\n# #################################################################################\n# ###########################     OUTPUT FORM     #################################\n# #################################################################################\n# write.csv(sbs_up_card, file=paste(local_path,\"output\\\\card_form\",\".csv\"), row.names=FALSE)\n\n\n#################################################################################\n###########################         INPUT FORMS             #####################\n########################### 1) card_form.csv w/ POOL entry  #####################\n########################### 2) draftkings salary info       #####################\n########################### 3) projections really do nothing...it's MMA anyway ##\n#################################################################################\n\npool_entry <- read.csv(file=paste0(local_path,\"output\\\\card_form \",\".csv\"), header=TRUE, sep=\",\")\npool_entry <- pool_entry[,15:16] \npool_entry <- pool_entry[complete.cases(pool_entry),]\n\nsalaries <- read.csv(file=paste0(local_path,\"output\\\\DKSalaries\",\".csv\"), header=TRUE, sep=\",\")\nsalaries <-salaries[,1:4]\nsalaries[salaries==\"\"]<-NA\nsalaries <-salaries[complete.cases(salaries),]\nsalaries[,2] <-toupper(salaries[,2])\n\npool_f<-append_dk_salary(pool_entry,salaries)\ntotal_combos<-get_all_lineups(pool_f)\n\nids <- read.csv(file=paste0(local_path,\"output\\\\DKSalaries\",\".csv\"), header=TRUE, sep=\",\")\nids <-ids[,1:2]\nids[ids==\"\"]<-NA\nids <-ids[complete.cases(ids),]\nids[,2] <-toupper(ids[,2])\n\ndk_lineups<-format_to_dk(total_combos, ids)\n\n#####################################################\n##################  WRITE OUTPUT  ###################\n#####################################################\nlu_check<-tryCatch({\n  read.csv(file=paste0(local_path,\"output\\\\DK_LINE\",\".csv\"), header=TRUE, sep=\",\")\n}, warning = function(w){lu_check<-NULL})\nif(is.null(lu_check)==TRUE){\n  write.csv(dk_lineups, file=paste0(local_path,\"output\\\\DK_LINE\",\".csv\"), row.names=FALSE)\n} else{\n  write.table(dk_lineups, file=paste0(local_path,\"output\\\\DK_LINE\",\".csv\"), sep=\",\", row.names=FALSE,col.names = FALSE, append=TRUE)\n  \n}\n\n# ####################################################################################\n# #FAKE SALARIES :: JUST IN CASE!\n# fake_sal <- read.csv(file=paste(local_path,\"card_form\",\".csv\"), header=TRUE, sep=\",\")\n# fake_sal <- fake_sal[,15]\n# fake_sal <- fake_sal[complete.cases(fake_sal)]\n# pool_entry<-cbind(pool_entry,fake_sal)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",
    "created" : 1475079559357.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3376225586",
    "id" : "40755B30",
    "lastKnownWriteTime" : 1475180998,
    "path" : "C:/git/fightmetrics/fightmetrics.R",
    "project_path" : "fightmetrics.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "type" : "r_source"
}